
# yaml-language-server: $schema=https://dv-flow.github.io/flow.dv.schema.json
package:
  name: uvm
  with:
    sim: 
      type: str
      # Set to one of the following with -Dsim=<simulator>
      # - mti - Mentor/Siemens Questa (Modelsim)
      # - vcs - Synopsys VCS
      # - xcm - Cadence Xcellium
      value: "vlt"

  tasks:
  - name: src
    uses: std.FileSet
    with:
      type: systemVerilogSource
      include: [top_pkg.sv, top.sv]
  - name: pythonpath
    uses: std.SetEnv
    with:
      prepend_path: 
        PYTHONPATH: ${{ srcdir }}
  
  - name: sim-img
    desc: Builds the simulation image
    uses: "hdlsim.${{ sim }}.SimImage"
    needs: 
    - "hdlsim.${{ sim }}.SimLibUVM"
    - pyhdl-if.UVMPkg
    - src
    with:
      top: [top]
        #      args: "--debug --gdbbt"

  - name: sim-run
    uses: "hdlsim.${{ sim }}.SimRun"
    needs: [pythonpath, sim-img, pyhdl-if.DpiLib]
    with:
      #      args: 
      #- "-valgrind --tool=memcheck"
      plusargs: 
      - UVM_TESTNAME=base_test
        #      - pyhdl.python=${{ rootdir }}/../../packages/python/bin/python
      - pyhdl.debug=0


